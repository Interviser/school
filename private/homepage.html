<!DOCTYPE html>
<html lang="en">
<head>
    <script>
         const verifyUser = async (e)=> {
            e.preventDefault()
           
            
            try { 
                const response = await fetch('api/auth/',{
                    method: 'GET',
                    credentials: 'include'
                })
                if(response.ok){
                     return
                }
                else {
                    window.location.replace('login.html')
                    throw new Error('User not authenticated')}
                           
                }
             catch (err) {

                window.location.replace('login.html')
            }
        
        }
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.css">
    <title>Document</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: Arial, sans-serif;
            box-sizing: border-box;
        }
        @media (min-width:768px) {
            #school_logo {
            height: 14%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            background-color: purple;
            color: white;
        }
        #school_crest {
            width: 70px;
            height: 70px;
            border-radius: 50%;
        }
        #logout_button {
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            background-color: none;
        }
        #for_iframe {
            height: 70%;
            width: 100%;
        }
        #for_nav {
            height: 8%;
            width: 100%;
        }
        nav {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: space-around;
            align-items: center;
            background-color: #f0f0f0;
        }
        #annouce, #contact, #test, #history, #timetable {
            width: 18%;
            font-size: 16px;
            cursor: pointer;
            height: 60%;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            border: none;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        button:hover {
            background-color: purple;
            color: white;
        }
        button:active {
            transform: scale(0.98);
        }
        }
        @media (max-width:767px) {
            #school_logo {
                height: 20%;
                width: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: purple;
                color: white;
                padding: 10px 0;
            }
            #school_crest {
                width: 50px;
                height: 50px;
                border-radius: 50%;
            }
            #logout_button {
                margin-top: 8px;
                padding: 6px 12px;
                font-size: 12px;
                background-color: none;
            }
            #for_iframe {
                height: 65%;
                width: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            #for_nav {
                height: 10%;
                width: 100%;
            }
            nav {
                height: 100%;
                width: 100%;
                display: flex;
                justify-content: space-around;
                align-items: center;
                background-color: #f0f0f0;
            }
            #annouce, #contact, #test, #history, #timetable,#change_password {
                width: 18%;
                font-size: 14px;
                cursor: pointer;
                height: 60%;
                justify-content: center;
                align-items: center;
                border-radius: 8px;
                border: none;
            }
            button:focus {
                outline: none;
                box-shadow: 0 0 5px purple;
                background-color: purple;
                color: white;
            }   
            iframe {
                width: 100%;
                height: 100%;
                border: none;
            }
            button:hover {
                background-color: purple;
                color: white;
            }
            button:active {
                transform: scale(0.98);
            }
        }
        
    </style>
</head>
<body>
    <section id="school_logo">
        <div>
            <img src="./images/CCIS.jpg" alt="School Logo" loading="lazy" id="school_crest">
            <span>STUDENTS' PORTAL</span>
        </div>
        <div>
            <span id="salutation"></span>
            <button id="logout_button">Logout</button>
        </div>
    </section>
    <section id="for_nav">
        <nav>
            <button id="annouce">Annoucement</button>
           <!-- <button id="contact">Contact</button> -->
            <button id="test">Assignments</button>
            <button id="history">History</button>
            <button id="timetable">Timetable</button>
            <button id="change_password">Change Password</button>
        </nav>
    </section>
    <section id="for_iframe">
        <iframe src="stu_announcement.html" frameborder="0" id="iframe"></iframe>
    </section>
     <script src="../../node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
    <script>
        const iframe = document.getElementById('iframe'); 
        document.getElementById('annouce').addEventListener('click', () => {
            iframe.src = 'stu_announcement.html';
        });
       /* document.getElementById('contact').addEventListener('click', () => {
            iframe.src = 'contact.html';
        }); */
        document.getElementById('test').addEventListener('click', () => {
            iframe.src = 'Assignments.html';
        });
        document.getElementById('history').addEventListener('click', () => {
            iframe.src = 'history.html';
        });
        document.getElementById('timetable').addEventListener('click', () => {
            iframe.src = 'timetable.html';
        });
        document.getElementById('change_password').addEventListener('click', () => {
            iframe.src = 'changeStuPassword.html';
        });
        
       


        const salutation = document.getElementById('salutation');
        const firstName = localStorage.getItem('firstName');
        salutation.textContent = `Welcome, ${firstName} ðŸ™Œ`;

        const logoutButton = document.getElementById('logout_button');
        logoutButton.addEventListener('click', () => {
            const confirmLogout = confirm('Are you sure you want to logout?');
            if (!confirmLogout) return;
            fetch('api/logout', {
                method: 'POST',
                credentials: 'include'
            }).then(response => {
                if (response.ok) {
                    window.location.replace('login.html');
                    localStorage.removeItem('firstName');
                    localStorage.removeItem('userId');
                    localStorage.removeItem('role');
                } else {
                    alert('Logout failed. Please try again.');
                     
                }
            }).catch(error => {
                
                alert('An error occurred. Please try again.');
            });
        });
        
    </script>
</body>

</html>